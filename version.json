{
  "version": "2.5.40",
  "build_date": "2026-02-28",
  "download_url": "https://github.com/GuyMayer/SideKick_PS/releases/latest/download/SideKick_PS_Setup.exe",
  "release_notes": "Review Order toolbar button, EXE code signing with RFC 3161 timestamping, VS Code workspace performance fix",
  "changelog": [
    "NEW: Review Order toolbar button — opens ProSelect Orders > Review Order via Alt+O menu shortcut",
    "NEW: Review Order uses font glyph icon (Receipt U+E762) matching all other toolbar buttons",
    "NEW: Review Order button toggle in Toolbar settings tab with amber icon and click-to-toggle",
    "NEW: Review Order visibility persists to INI (ShowBtn_ReviewOrder)",
    "NEW: Code signing — all compiled EXEs in Release folder are now digitally signed before installer build",
    "NEW: RFC 3161 timestamping — signatures remain valid after certificate expiry",
    "NEW: Timestamp server failover — tries Certum, DigiCert, Sectigo in sequence",
    "IMPROVED: Code signing applies to SideKick_PS.exe and all Python helper EXEs, not just the installer",
    "FIX: PayPlan EnteringPaylines flag not reset after payment write - could block subsequent entries",
    "NEW: Open Folder toolbar button - opens the album's image source folder (extracted from PSConsole getImageData) in Explorer or configured editor",
    "NEW: GetAlbumSourceFolder() function - uses PSConsole getImageData to extract the actual image source path (shellpath) instead of the .psa file location",
    "NEW: Cardly template orientation swap - rotate button (â‡„) switches crop between Landscape and Portrait using matched template pairs",
    "NEW: Cardly orientation pair detection - auto-discovers Lâ†”P template pairs by case-insensitive base name matching",
    "NEW: Lead Connector QR toggle - switch QR code URL between white-label domain and LC app deep link",
    "NEW: Cardly Sign Up button in settings next to Dashboard",
    "NEW: Cardly Dashboard URL configurable from Settings (no longer hardcoded)",
    "NEW: Direct PSA payment writing - write_psa_payments.py injects payments directly into .psa SQLite files",
    "NEW: UpdatePS flow rewired: save album â†’ write payments to PSA â†’ reload album",
    "IMPROVED: Cardly sticker Open Folder option - opens sticker folder in Explorer from the dropdown",
    "IMPROVED: Cardly orientation pair detection now also matches by API ID as fallback (e.g. thankyou-photocard-l/p)",
    "IMPROVED: GoCardless always live - removed environment selector, hardcoded to live (fixes sandbox default bug)",
    "IMPROVED: GoCardless wizard simplified from 5 to 4 steps (removed environment selection)",
    "IMPROVED: Plan naming Order Date - new dropdown option reads order date from .psa album file",
    "IMPROVED: Plan naming format now auto-generates the default plan name in payment dialog",
    "IMPROVED: PSConsole saveAlbum replaces Ctrl+S keyboard automation (no blind 3s sleep)",
    "IMPROVED: PSConsole openAlbum replaces Ctrl+O with smart single-PSA detection",
    "IMPROVED: Cardly message box height doubled (4â†’8 lines) for longer messages",
    "IMPROVED: Cardly multiline message support - \\n escape chain across INI/AHK/cmdline/Python",
    "IMPROVED: Cardly spinner animation replaces stalling progress bar (canvas-based spinning dots)",
    "IMPROVED: Card Details panel shows orientation label (Landscape/Portrait) next to dimensions",
    "IMPROVED: GoCardless crash handler - unhandled errors now print ERROR to stdout instead of silent empty output",
    "IMPROVED: GoCardless empty output detection - shows antivirus/exe blocking message instead of blank error",
    "IMPROVED: Cardly orientation matching strips trailing numeric IDs (e.g. -11482) from API template IDs before pair comparison",
    "IMPROVED: Cardly preview window icon - all GUI windows show SideKick icon in title bar and taskbar",
    "IMPROVED: Cardly send now runs on background thread - spinner animation stays smooth during network calls",
    "IMPROVED: All compiled Python executables now include SideKick icon",
    "NEW: Cardly Orders button in settings - opens order management page directly",
    "FIX: GoCardless environment default - hardcoded to live, fixes test connection failure with live tokens",
    "FIX: GHL tag sync - INI key mismatch (Tags vs SyncTag, OppTags vs OpportunityTags)",
    "FIX: Cardly address validation - state/county no longer required (UK addresses)",
    "FIX: Build - added write_psa_payments, read_psa_payments, read_psa_images, create_ghl_contactsheet to compile pipeline and installer",
    "FIX: Build - write_psa_payments now uses GetScriptPath() instead of hardcoded .py path",
    "NEW: Graphical Toolbar Button Settings - clickable icons instead of toggle sliders",
    "NEW: Visual Toggle Feedback - icons and labels change color when disabled",
    "IMPROVED: Direct toggle updates - button visibility changes immediately on click",
    "NEW: Bank Transfer Display - show bank details on fullscreen display for client payments",
    "NEW: Slide Cycling - display cycles through QR codes, bank details, and images (â†‘â†“ keys)",
    "NEW: Scalable Bank Display - bank text scales with Size slider same as QR codes",
    "IMPROVED: Sort code auto-formatted as ##-##-## on display",
    "NEW: Terms of Service pages - comprehensive terms.html for docs and website",
    "IMPROVED: EULA - added Third-Party Services, Indemnification, expanded liability sections",
    "IMPROVED: Privacy Policy - detailed warranty disclaimers, third-party notices, indemnification",
    "IMPROVED: Manual - enhanced GHL and GoCardless disclaimers with AS IS language",
    "FIX: GoCardless auto-detect scheme - removed hardcoded BACS, supports BECS/SEPA/ACH/PAD",
    "NEW: Direct PSA file reading - extract payments and thumbnails from .psa album files",
    "NEW: GoCardless payment dialog reads from .psa instead of XML export",
    "NEW: Contact sheet generation extracts thumbnails from .psa directly",
    "NEW: GC past payment detection - detects past due dates and offers to bump to future",
    "NEW: GC dynamic icon color - toolbar icon matches toolbar color scheme",
    "NEW: Clipboard helper functions - preserve user clipboard during copy operations",
    "FIX: GHL invoice creation - remove taxInclusive from Â£0 items (HTTP 422 error)",
    "FIX: GetAlbumFolder path - uses Alt+D trick instead of breadcrumb text",
    "FIX: Payment regex now handles decimal values (e.g., Â£91.70)",
    "FIX: GC Search Mandate dialog now stays on top",
    "FIX: GHL settings Auto-save XML toggle hides on other tabs",
    "FIX: Build script now copies icon source files for installer",
    "IMPROVED: Update check frequency changed from monthly to weekly",
    "IMPROVED: GHL settings panel - added Auto-save XML toggle",
    "IMPROVED: Toolbar background color renders correctly on first launch",
    "IMPROVED: No Plans list excludes mandates that ever had subscriptions",
    "IMPROVED: Real-time progress bar during mandate fetch",
    "FIX: Progress bar freezing during mandate fetch",
    "NEW: Mandate check - searches GoCardless for existing customer mandates",
    "NEW: Send mandate request via GHL email and/or SMS templates",
    "NEW: GoCardless API token stored securely in credentials.json",
    "NEW: Payment plan dialog creates instalment schedules with auto-populated values",
    "NEW: DD payment filtering - skips non-DD payments (Card, Cash, Cheque)",
    "NEW: Duplicate plan names auto-suffixed (-1, -2) for same shoot",
    "NEW: Separate SMS template refresh (email and SMS templates now independent)",
    "NEW: Existing instalment schedules and one-off payments shown when checking mandate",
    "NEW: One-off payments listed alongside plans for complete payment history",
    "NEW: Single payment mode - create individual payments matching ProSelect PayPlan dates",
    "NEW: List empty mandates - shows mandates without payment plans for follow-up",
    "IMPROVED: Uses GoCardless instalment_schedules API (not subscriptions)",
    "IMPROVED: Email/SMS template dropdowns now persistent (saved immediately)",
    "IMPROVED: Warns before creating plan with duplicate name",
    "FIX: Live environment flag - GoCardless API now uses correct environment",
    "FIX: SMS template cache - dropdown now uses SMS templates not email",
    "FIX: SELECT option added to template dropdowns to skip notifications",
    "FIX: Template dropdown shows SELECT by default when no templates loaded",
    "FIX: GC email/SMS templates no longer reset when Settings dialog opened"
  ],
  "versions": [
    {
      "version": "2.5.39",
      "build_date": "2026-02-27",
      "release_notes": "Fix GHL photo link URL mismatch; Cardly test mode documentation",
      "changelog": [
        "FIX: GHL Photo Link URL - normalise upload URL to public CDN domain (assets.cdn.filesafe.space)",
        "FIX: GoCardless API token rejected - Base64_Encode now uses NOCRLF flag to prevent broken JSON credentials",
        "FIX: GoCardless token input now trimmed of whitespace on entry",
        "DOCS: Cardly Test Mode - documented what test mode validates vs skips, cost implications, and orphaned artwork",
        "DOCS: User Manual - new Greeting Cards (Cardly) section with workflow, test mode table, image sources, requirements"
      ]
    },
    {
      "version": "2.5.39",
      "build_date": "2026-02-27",
      "release_notes": "GoCardless Direct Debit integration with instalment schedules, mandate checking, and GHL notifications",
      "changelog": [
        "NEW: GoCardless toolbar button - check mandates and send setup links",
        "NEW: GoCardless settings tab with API config and GHL template selectors",
        "NEW: Mandate check - searches GoCardless for existing customer mandates",
        "NEW: Send mandate request via GHL email and/or SMS templates",
        "NEW: GoCardless API token stored securely in credentials.json",
        "NEW: Payment plan dialog creates instalment schedules with auto-populated values",
        "NEW: DD payment filtering - skips non-DD payments (Card, Cash, Cheque)",
        "NEW: Duplicate plan names auto-suffixed (-1, -2) for same shoot",
        "NEW: Separate SMS template refresh (email and SMS templates now independent)",
        "NEW: Existing instalment schedules and one-off payments shown when checking mandate",
        "NEW: One-off payments listed alongside plans for complete payment history",
        "NEW: Single payment mode - create individual payments matching ProSelect PayPlan dates",
        "NEW: List empty mandates - shows mandates without payment plans for follow-up",
        "IMPROVED: Uses GoCardless instalment_schedules API (not subscriptions)",
        "IMPROVED: Email/SMS template dropdowns now persistent (saved immediately)",
        "IMPROVED: Warns before creating plan with duplicate name",
        "FIX: Live environment flag - GoCardless API now uses correct environment",
        "FIX: SMS template cache - dropdown now uses SMS templates not email",
        "FIX: SELECT option added to template dropdowns to skip notifications",
        "FIX: Template dropdown shows SELECT by default when no templates loaded",
        "FIX: GC email/SMS templates no longer reset when Settings dialog opened"
      ]
    },
    {
      "version": "2.5.39",
      "build_date": "2026-02-27",
      "release_notes": "Toolbar auto-blend, ESC to cancel export",
      "changelog": [
        "NEW: Auto-blend toolbar background - samples screen behind toolbar and matches color",
        "NEW: Setting in Hotkeys > Toolbar Appearance to enable/disable auto-blend",
        "NEW: Press ESC during invoice export to cancel with confirmation dialog",
        "FIX: Toolbar click-through issue on transparent button edges (TransColor 010101)",
        "IMPROVED: Toolbar blends seamlessly with ProSelect title bar when auto-blend enabled"
      ]
    },
    {
      "version": "2.5.39",
      "build_date": "2026-02-27",
      "release_notes": "CRITICAL: Fix GHL invoice creation - rich item names, per-line tax, verbose error logging",
      "changelog": [
        "FIX: GHL invoice creation failed when Product_Name was empty (Wall Groupings, Collections)",
        "FIX: Invoice item names now combine Template + Description for richer display",
        "NEW: Per-line item tax sent to GHL (20% VAT with inclusive/exclusive flag)",
        "NEW: Always-on error logging (sync_error_*.log) for critical failures",
        "NEW: Error logs auto-upload to Gist for remote diagnostics",
        "IMPROVED: Detailed error context for GHL API failures, XML parsing, and missing contact ID"
      ]
    },
    {
      "version": "2.5.39",
      "build_date": "2026-02-27",
      "release_notes": "Setup Wizard auto-refresh, ProSelect auto-launch, website SEO improvements",
      "changelog": [
        "NEW: Setup Wizard auto-loads GHL tags, opportunity tags, and email templates after setup",
        "NEW: Setup Wizard offers to launch ProSelect and wait up to 60s for print template loading",
        "NEW: Manual button in General Settings opens online documentation",
        "NEW: Docs button in About tab links to field mapping documentation",
        "NEW: Website sitemap.xml and robots.txt for search engine indexing",
        "NEW: JSON-LD schema for Google and AI search (SoftwareApplication, FAQPage)",
        "NEW: Open Graph and Twitter Card meta tags for social sharing",
        "IMPROVED: App Settings group box simplified - removed ProSelect version display",
        "IMPROVED: Silent refresh functions for tags and templates (no dialogs during setup)"
      ]
    },
    {
      "version": "2.5.39",
      "build_date": "2026-02-27",
      "release_notes": "SKU/Product_Code extraction for GHL/Xero/QuickBooks product matching",
      "changelog": [
        "NEW: SKU field (Product_Code) extracted from ProSelect XML for product matching",
        "NEW: Full tax details extracted (tax_label, tax_rate, price_includes_tax)",
        "NEW: Product line code and name extracted for categorization",
        "NEW: Size and Template_Name fields for product identification",
        "NEW: ProSelect item ID preserved for traceability",
        "IMPROVED: All ProSelect fields passed through unchanged - no string merging",
        "IMPROVED: Invoice items include all fields needed for Xero/QuickBooks sync"
      ]
    },
    {
      "version": "2.5.39",
      "build_date": "2026-02-27",
      "release_notes": "GHL API compatibility fix for PIT tokens, secure credential storage",
      "changelog": [
        "FIX: GHL API updated to new endpoint for PIT token support",
        "IMPROVED: API keys now stored only in credentials.json (removed from INI)"
      ]
    },
    {
      "version": "2.5.39",
      "build_date": "2026-02-27",
      "release_notes": "PDF toolbar button, GHL Client QR code with barcode scanner support, dynamic agency domain, improved icons",
      "changelog": [
        "NEW: Dedicated PDF toolbar button (maroon) - always prints to PDF",
        "NEW: GHL Client QR Code - unified format works for both phones and barcode scanners",
        "NEW: Dynamic GHL agency domain - auto-detected from login URL, configurable per account",
        "NEW: PDF overwrite protection - auto-appends _1, _2, etc. if file exists",
        "NEW: Quick Print tooltip shows default printer name",
        "NEW: ID Card icon for GHL button, Person+ icon for Get Client button",
        "NEW: Print to PDF hands-off mode with warning GUI during automation",
        "NEW: PDF copy folder auto-created if it doesn't exist",
        "IMPROVED: Print to PDF focus handling - clicks dialog to ensure keyboard focus",
        "IMPROVED: PDF named after album folder instead of subfolder",
        "IMPROVED: Quick Print always uses default printer (PDF button for PDF output)",
        "FIX: Correct Save button clicked in Save dialog",
        "FIX: Removed GUI Flash that was stealing focus"
      ]
    },
    {
      "version": "2.5.39",
      "build_date": "2026-02-27",
      "release_notes": "Detailed sync error dialogs, timestamped logs with 7-day retention, email-first contact search",
      "changelog": [
        "NEW: Detailed error dialog when invoice sync fails - shows available data and what's missing",
        "NEW: Clickable log folder path in Settings > About",
        "NEW: Timestamped log files preserved for 7 days",
        "IMPROVED: Email-first contact search in GHL (more reliable)",
        "IMPROVED: Helper version logging for diagnostics",
        "FIX: Logs now write to AppData instead of protected Program Files folder",
        "FIX: What's New button now shows version history"
      ]
    },
    {
      "version": "2.5.39",
      "build_date": "2026-02-27",
      "release_notes": "Toolbar grab handle and positioning",
      "changelog": [
        "NEW: Toolbar grab handle - Ctrl+Click and drag to reposition",
        "NEW: Position is saved relative to ProSelect window (persistent)",
        "NEW: Reset Position button in Settings > Shortcuts > Toolbar Appearance",
        "FIX: Toolbar tooltips now appear on hover"
      ]
    },
    {
      "version": "2.5.39",
      "build_date": "2026-02-27",
      "release_notes": "Local QR code generation, monitor selection for QR display",
      "changelog": [
        "NEW: Local QR Code Generation - no more Google Charts API dependency",
        "NEW: QR Code Caching - pre-generated on startup for instant display",
        "NEW: Monitor Selection - choose which monitor displays QR codes",
        "IMPROVED: Flash-Free QR Cycling - controls update without GUI rebuild",
        "IMPROVED: Smart Dialog Detection - toolbar hides for ProSelect dialogs"
      ]
    },
    {
      "version": "2.5.39",
      "build_date": "2026-02-27",
      "release_notes": "Print to PDF with secondary folder copy, DPI-scaled toolbar",
      "changelog": [
        "NEW: Print to PDF - save PDF to album folder with optional copy to secondary folder",
        "NEW: Print Settings Tab - dedicated settings for print templates and PDF output",
        "IMPROVED: DPI-Scaled Toolbar - all dimensions scale with display DPI",
        "FIX: Contact sheet saves to album directory instead of Program Files"
      ]
    },
    {
      "version": "2.5.39",
      "build_date": "2026-02-27",
      "release_notes": "Room capture email template picker, invoice deletion, shortcuts tab",
      "changelog": [
        "NEW: Room Capture Email Template Picker - choose from GHL templates",
        "NEW: Shortcuts Tab - configure toolbar buttons and quick print templates",
        "NEW: Invoice Deletion - Ctrl+Click Sync Invoice button to delete",
        "IMPROVED: Contact and Opportunity Tagging during invoice sync"
      ]
    },
    {
      "version": "2.5.39",
      "build_date": "2026-02-27",
      "release_notes": "DPI scaling for DarkMsgBox dialogs",
      "changelog": [
        "IMPROVED: Full high-DPI display support for DarkMsgBox",
        "FIX: Button sizing and positioning scales with DPI"
      ]
    },
    {
      "version": "2.5.39",
      "build_date": "2026-02-27",
      "release_notes": "Invoice sync enhancements with payment schedules and VAT summary",
      "changelog": [
        "IMPROVED: Payment schedules show as invoice line items with dates",
        "IMPROVED: VAT/Tax summary on invoices (Subtotal ex VAT, VAT, Total)",
        "IMPROVED: Only past payments recorded as transactions",
        "FIX: Export workflow with extended sleep and Cancel button",
        "FIX: Dark mode consistency for all dialogs"
      ]
    },
    {
      "version": "2.5.39",
      "build_date": "2026-02-27",
      "release_notes": "Date calculation bug fixes",
      "changelog": [
        "FIX: DateDiff errors - replaced with AHK v1 compatible EnvSub",
        "FIX: License expiry calculation",
        "FIX: Trial period validation"
      ]
    },
    {
      "version": "2.5.39",
      "build_date": "2026-02-27",
      "release_notes": "DarkMsgBox function, Import/Export settings",
      "changelog": [
        "NEW: DarkMsgBox - universal dark mode message box",
        "NEW: Import/Export Settings - share settings between computers",
        "NEW: Contact Sheet toggle in Invoice tab",
        "IMPROVED: Dark mode title bar support",
        "FIX: Installer and Python script references"
      ]
    },
    {
      "version": "2.5.39",
      "build_date": "2026-02-27",
      "release_notes": "Major GHL integration release",
      "changelog": [
        "NEW: GHL Client lookup from Chrome URLs",
        "NEW: Auto-populate ProSelect from GHL data",
        "NEW: Invoice sync to GHL with media upload",
        "NEW: Payment plan calculator"
      ]
    }
  ]
}
